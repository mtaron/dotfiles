{{- $isGnome := lookPath "gnome-shell" | not | not -}}

{{- $headless := true -}}
{{- $ephemeral := not stdinIsATTY -}}

{{- if $isGnome -}}
{{-   $headless = false -}}
{{- else if stdinIsATTY -}}
{{-   $headless = promptBoolOnce . "headless" "headless" false -}}
{{-   $ephemeral = promptBoolOnce . "ephemeral" "ephemeral" false -}}
{{- end -}}

{{- $email := default "michael@taron.dev" (env "GIT_AUTHOR_EMAIL") -}}

{{/* workloads */}}
{{- $kubernetesWorloadEnabled := lookPath "kubectl" | not | not }}
{{- $kubernetesVersions := list "1.28" "1.29" "1.30" -}}
{{- $kubernetesVersion := "1.28" -}}

{{- $dockerWorloadEnabled := lookPath "docker" | not | not }}

{{- if stdinIsATTY -}}
{{-   $email = promptStringOnce . "user.email" "email" $email -}}
{{-   if not $kubernetesWorloadEnabled -}}
{{-     $kubernetesWorloadEnabled = promptBool . "workload.kubernetes.enabled" "‚ò∏ kubernetes" $kubernetesWorloadEnabled -}}
{{-     if $kubernetesWorloadEnabled -}}
{{-       $kubernetesVersion = promptChoiceOnce . "workload.kubernetes.version" "kubernetes version" $kubernetesVersions $kubernetesVersion -}}
{{-     end -}}
{{-   end -}}
{{-   if not $dockerWorloadEnabled -}}
{{-     $dockerWorloadEnabled = promptBool . "workload.docker.enabled" "üê≥ docker" $dockerWorloadEnabled -}}
{{-   end -}}
{{- end -}}

gitHub:
  refreshPeriod: "15m"

data:
  headless: {{ $headless }}
  isGnome: {{ $isGnome }}
  ephemeral: {{ $ephemeral }}

  user:
    name: "Michael Taron"
    email: {{ quote $email }}
    github: "mtaron"

  workload:
    docker:
      enabled: {{ $dockerWorloadEnabled }}
    kubernetes:
      enabled: {{ $kubernetesWorloadEnabled }}
      version: {{ quote $kubernetesVersion }}
